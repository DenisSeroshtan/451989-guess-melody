{"version":3,"file":"player.js","sources":["js/player.js"],"sourcesContent":["const updateState = (element, player) => {\n  element.querySelector(`.player-status`).style.width =\n      `${parseInt(player.currentTime * 100 / player.duration, 10)}%`;\n};\n\n\nconst syncState = (player, element) => {\n  element.classList.toggle(`player--is-playing`, !player.paused);\n};\n\n\nconst switchState = (state, player, element) => {\n  if (player.paused) {\n    player.play();\n    state.stopAnimation = window.animation.animate(\n        window.animation.getAnimation(player.currentTime, 1000, player.duration),\n        (animation) => updateState(element, player));\n  } else {\n    player.pause();\n    state.stopAnimation();\n    state.stopAnimation = null;\n  }\n\n  syncState(player, element);\n};\n\n\nconst destroyPlayer = (element, state) => {\n  const player = element.querySelector(`audio`);\n  const button = element.querySelector(`button`);\n\n  if (state.stopAnimation) {\n    state.stopAnimation();\n  }\n\n  player.src = null;\n  button.onclick = null;\n  element.innerHTML = ``;\n  state = null;\n\n  return true;\n};\n\n\nwindow.initializePlayer = (element, file, autoplay = false, controllable = true) => {\n  let state = {};\n\n  const content = document.querySelector(`template`)\n    .content\n    .querySelector(`.player`)\n    .cloneNode(true);\n  const player = content.querySelector(`audio`);\n  const button = content.querySelector(`button`);\n\n  player.onloadeddata = () => {\n    if (controllable) {\n      button.onclick = () => switchState(state, player, content);\n    }\n\n    if (autoplay) {\n      switchState(state, player, content);\n    }\n  };\n\n  player.src = file;\n  element.appendChild(content);\n  element.classList.toggle(`player--no-controls`, !controllable);\n\n  return () => destroyPlayer(element, state);\n};\n"],"names":["updateState","element","player","querySelector","style","width","parseInt","currentTime","duration","syncState","classList","toggle","paused","switchState","state","play","stopAnimation","window","animation","animate","getAnimation","pause","destroyPlayer","button","src","onclick","innerHTML","initializePlayer","file","autoplay","controllable","content","document","cloneNode","onloadeddata","appendChild"],"mappings":";;;AAAA,IAAMA,cAAc,SAAdA,WAAc,CAACC,OAAD,EAAUC,MAAV,EAAqB;UAC/BC,aAAR,mBAAwCC,KAAxC,CAA8CC,KAA9C,GACOC,SAASJ,OAAOK,WAAP,GAAqB,GAArB,GAA2BL,OAAOM,QAA3C,EAAqD,EAArD,CADP;CADF;;AAMA,IAAMC,YAAY,SAAZA,SAAY,CAACP,MAAD,EAASD,OAAT,EAAqB;UAC7BS,SAAR,CAAkBC,MAAlB,uBAA+C,CAACT,OAAOU,MAAvD;CADF;;AAKA,IAAMC,cAAc,SAAdA,WAAc,CAACC,KAAD,EAAQZ,MAAR,EAAgBD,OAAhB,EAA4B;MAC1CC,OAAOU,MAAX,EAAmB;WACVG,IAAP;UACMC,aAAN,GAAsBC,OAAOC,SAAP,CAAiBC,OAAjB,CAClBF,OAAOC,SAAP,CAAiBE,YAAjB,CAA8BlB,OAAOK,WAArC,EAAkD,IAAlD,EAAwDL,OAAOM,QAA/D,CADkB,EAElB,UAACU,SAAD;aAAelB,YAAYC,OAAZ,EAAqBC,MAArB,CAAf;KAFkB,CAAtB;GAFF,MAKO;WACEmB,KAAP;UACML,aAAN;UACMA,aAAN,GAAsB,IAAtB;;;YAGQd,MAAV,EAAkBD,OAAlB;CAZF;;AAgBA,IAAMqB,gBAAgB,SAAhBA,aAAgB,CAACrB,OAAD,EAAUa,KAAV,EAAoB;MAClCZ,SAASD,QAAQE,aAAR,SAAf;MACMoB,SAAStB,QAAQE,aAAR,UAAf;;MAEIW,MAAME,aAAV,EAAyB;UACjBA,aAAN;;;SAGKQ,GAAP,GAAa,IAAb;SACOC,OAAP,GAAiB,IAAjB;UACQC,SAAR;UACQ,IAAR;;SAEO,IAAP;CAbF;;AAiBAT,OAAOU,gBAAP,GAA0B,UAAC1B,OAAD,EAAU2B,IAAV,EAA0D;MAA1CC,QAA0C,uEAA/B,KAA+B;MAAxBC,YAAwB,uEAAT,IAAS;;MAC9EhB,QAAQ,EAAZ;;MAEMiB,UAAUC,SAAS7B,aAAT,aACb4B,OADa,CAEb5B,aAFa,YAGb8B,SAHa,CAGH,IAHG,CAAhB;MAIM/B,SAAS6B,QAAQ5B,aAAR,SAAf;MACMoB,SAASQ,QAAQ5B,aAAR,UAAf;;SAEO+B,YAAP,GAAsB,YAAM;QACtBJ,YAAJ,EAAkB;aACTL,OAAP,GAAiB;eAAMZ,YAAYC,KAAZ,EAAmBZ,MAAnB,EAA2B6B,OAA3B,CAAN;OAAjB;;;QAGEF,QAAJ,EAAc;kBACAf,KAAZ,EAAmBZ,MAAnB,EAA2B6B,OAA3B;;GANJ;;SAUOP,GAAP,GAAaI,IAAb;UACQO,WAAR,CAAoBJ,OAApB;UACQrB,SAAR,CAAkBC,MAAlB,wBAAgD,CAACmB,YAAjD;;SAEO;WAAMR,cAAcrB,OAAd,EAAuBa,KAAvB,CAAN;GAAP;CAxBF;;"}